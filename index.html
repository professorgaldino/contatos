<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Tabela de Contatos - Layout Específico</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      margin: 0;
    }
    .search-container {
      position: sticky;
      top: 0;
      background: white;
      padding: 15px 0;
      z-index: 100;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    #pesquisa {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .table-container {
      overflow-x: auto;
      margin-top: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      max-height: 80vh;
      overflow-y: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 1800px;
    }
    th, td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      white-space: nowrap;
    }
    th {
      background-color: #2c3e50;
      color: white;
      position: sticky;
      top: 0;
      font-weight: normal;
      font-size: 14px;
    }
    tr:hover {
      background-color: #f5f5f5;
    }
    .loading, .no-results {
      text-align: center;
      padding: 20px;
    }
    .no-results {
      color: #e74c3c;
    }
    .empty-field {
      color: #95a5a6;
      font-style: italic;
    }
    .has-value {
      background-color: #ecf0f1;
    }
  </style>
</head>
<body>

<h2>Lista de Contatos</h2>
<div class="search-container">
  <input type="text" id="pesquisa" placeholder="Digite para filtrar em qualquer campo..." oninput="filtrarTabela()">
</div>

<div class="table-container">
  <table id="tabelaContatos">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Middle Name</th>
        <th>Last Name</th>
        <th>Phonetic First Name</th>
        <th>Phonetic Middle Name</th>
        <th>Phonetic Last Name</th>
        <th>Name Prefix</th>
        <th>Name Suffix</th>
        <th>Nickname</th>
        <th>File As</th>
        <th>Organization Name</th>
        <th>Organization Title</th>
        <th>Organization Department</th>
        <th>Birthday</th>
        <th>Notes</th>
        <th>Photo</th>
        <th>Labels</th>
        <th>E-mail 1 - Label</th>
        <th>E-mail 1 - Value</th>
        <th>Phone 1 - Label</th>
        <th>Phone 1 - Value</th>
        <th>Phone 2 - Label</th>
        <th>Phone 2 - Value</th>
        <th>Phone 3 - Label</th>
        <th>Phone 3 - Value</th>
        <th>Phone 4 - Label</th>
        <th>Phone 4 - Value</th>
        <th>Address 1 - Label</th>
        <th>Address 1 - Formatted</th>
        <th>Address 1 - Street</th>
        <th>Address 1 - City</th>
        <th>Address 1 - PO Box</th>
        <th>Address 1 - Region</th>
        <th>Address 1 - Postal Code</th>
        <th>Address 1 - Country</th>
        <th>Address 1 - Extended Address</th>
      </tr>
    </thead>
    <tbody id="corpoTabela">
      <tr><td colspan="35" class="loading">Carregando dados dos contatos...</td></tr>
    </tbody>
  </table>
</div>

<script>
// Lista fixa de campos na ordem exata que você definiu
const CAMPOS = [
  "First Name", "Middle Name", "Last Name",
  "Phonetic First Name", "Phonetic Middle Name", "Phonetic Last Name",
  "Name Prefix", "Name Suffix", "Nickname", "File As",
  "Organization Name", "Organization Title", "Organization Department",
  "Birthday", "Notes", "Photo", "Labels",
  "E-mail 1 - Label", "E-mail 1 - Value",
  "Phone 1 - Label", "Phone 1 - Value",
  "Phone 2 - Label", "Phone 2 - Value",
  "Phone 3 - Label", "Phone 3 - Value",
  "Phone 4 - Label", "Phone 4 - Value",
  "Address 1 - Label", "Address 1 - Formatted",
  "Address 1 - Street", "Address 1 - City", "Address 1 - PO Box",
  "Address 1 - Region", "Address 1 - Postal Code", "Address 1 - Country",
  "Address 1 - Extended Address"
];

let contatos = [];

function formatarValor(valor) {
  if (valor === null || valor === undefined || valor === "") {
    return '<span class="empty-field">-</span>';
  }
  return valor;
}

function renderizarTabela(dados) {
  const tbody = document.getElementById("corpoTabela");
  tbody.innerHTML = "";

  if (dados.length === 0) {
    tbody.innerHTML = `<tr><td colspan="${CAMPOS.length}" class="no-results">Nenhum resultado encontrado</td></tr>`;
    return;
  }

  dados.forEach(contato => {
    const tr = document.createElement("tr");
    
    CAMPOS.forEach(campo => {
      const td = document.createElement("td");
      const valor = contato[campo];
      td.innerHTML = formatarValor(valor);
      
      if (valor) td.classList.add("has-value");
      tr.appendChild(td);
    });
    
    tbody.appendChild(tr);
  });
}

function filtrarTabela() {
  const termo = document.getElementById("pesquisa").value.toLowerCase();
  
  if (!termo) {
    renderizarTabela(contatos);
    return;
  }

  const resultados = contatos.filter(contato => {
    return CAMPOS.some(campo => {
      const valor = contato[campo];
      return valor && valor.toString().toLowerCase().includes(termo);
    });
  });

  renderizarTabela(resultados);
}

// Carregar dados
fetch('contatos.json')
  .then(response => response.json())
  .then(data => {
    contatos = Array.isArray(data) ? data : [data];
    renderizarTabela(contatos);
  })
  .catch(error => {
    document.getElementById("corpoTabela").innerHTML = 
      `<tr><td colspan="${CAMPOS.length}" class="no-results">Erro ao carregar: ${error.message}</td></tr>`;
    console.error("Erro:", error);
  });
</script>
</body>
</html>
