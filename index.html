<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Contatos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 8px;
      border: 1px solid #ddd;
      text-align: left;
      font-size: 14px;
    }

    th {
      background-color: #007BFF;
      color: white;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    tr:hover {
      background-color: #f1f1f1;
      cursor: pointer;
    }

    .empty-field {
      color: #bbb;
      font-style: italic;
    }

    .no-results {
      text-align: center;
      font-weight: bold;
      color: #d00;
      padding: 20px;
    }
  </style>
</head>
<body>

<h1>Lista de Contatos</h1>

<input type="text" id="pesquisa" placeholder="Digite para buscar...">

<table>
  <thead>
    <tr>
      <th>First Name</th>
      <th>Middle Name</th>
      <th>Last Name</th>
      <th>Phonetic First Name</th>
      <th>Phonetic Middle Name</th>
      <th>Phonetic Last Name</th>
      <th>Name Prefix</th>
      <th>Name Suffix</th>
      <th>Nickname</th>
      <th>File As</th>
      <th>Organization Name</th>
      <th>Organization Title</th>
      <th>Organization Department</th>
      <th>Birthday</th>
      <th>Notes</th>
      <th>Photo</th>
      <th>Labels</th>
      <th>E-mail 1 - Label</th>
      <th>E-mail 1 - Value</th>
      <th>Phone 1 - Label</th>
      <th>Phone 1 - Value</th>
      <th>Phone 2 - Label</th>
      <th>Phone 2 - Value</th>
      <th>Phone 3 - Label</th>
      <th>Phone 3 - Value</th>
      <th>Phone 4 - Label</th>
      <th>Phone 4 - Value</th>
      <th>Address 1 - Label</th>
      <th>Address 1 - Formatted</th>
      <th>Address 1 - Street</th>
      <th>Address 1 - City</th>
      <th>Address 1 - PO Box</th>
      <th>Address 1 - Region</th>
      <th>Address 1 - Postal Code</th>
      <th>Address 1 - Country</th>
      <th>Address 1 - Extended Address</th>
    </tr>
  </thead>
  <tbody id="corpoTabela"></tbody>
</table>

<script>
let contatos = [];
let contatosFiltrados = [];

function normalizarTexto(texto) {
  return texto
    ?.normalize("NFD")                // separa os acentos
    .replace(/[\u0300-\u036f]/g, "") // remove os acentos
    .toLowerCase()
    .trim();
}

function filtrarTabela() {
  const termo = normalizarTexto(document.getElementById("pesquisa").value);
  if (!termo) {
    renderizarTabela(contatos.slice(0, 300)); // mostra só os primeiros 300
    return;
  }

  contatosFiltrados = contatos.filter(c => {
    return Object.values(c).some(v => normalizarTexto(v).includes(termo));
  });

  renderizarTabela(contatosFiltrados.slice(0, 300));
}

function renderizarTabela(dados) {
  const tbody = document.getElementById("corpoTabela");
  tbody.innerHTML = "";

  if (dados.length === 0) {
    tbody.innerHTML = `<tr><td colspan="36" class="no-results">Nenhum resultado encontrado</td></tr>`;
    return;
  }

  const fragment = document.createDocumentFragment();
  dados.forEach(contato => {
    const tr = document.createElement("tr");
    tr.addEventListener("click", () => mostrarDetalhes(contato));

    const campos = [
      "First Name", "Middle Name", "Last Name",
      "Phonetic First Name", "Phonetic Middle Name", "Phonetic Last Name",
      "Name Prefix", "Name Suffix", "Nickname", "File As",
      "Organization Name", "Organization Title", "Organization Department",
      "Birthday", "Notes", "Photo", "Labels",
      "E-mail 1 - Label", "E-mail 1 - Value",
      "Phone 1 - Label", "Phone 1 - Value",
      "Phone 2 - Label", "Phone 2 - Value",
      "Phone 3 - Label", "Phone 3 - Value",
      "Phone 4 - Label", "Phone 4 - Value",
      "Address 1 - Label", "Address 1 - Formatted", "Address 1 - Street",
      "Address 1 - City", "Address 1 - PO Box", "Address 1 - Region",
      "Address 1 - Postal Code", "Address 1 - Country", "Address 1 - Extended Address"
    ];

    campos.forEach(campo => {
      const td = document.createElement("td");
      const valor = contato[campo] || '';
      td.textContent = valor;
      if (!valor) {
        td.classList.add("empty-field");
        td.textContent = "-";
      }
      tr.appendChild(td);
    });

    fragment.appendChild(tr);
  });

  tbody.appendChild(fragment);
}

// Simula clique (você pode remover ou implementar o que quiser aqui)
function mostrarDetalhes(contato) {
  console.log("Contato selecionado:", contato);
}

// Carregar os contatos
fetch("contatos.json")
  .then(response => response.json())
  .then(data => {
    contatos = data;
    renderizarTabela(contatos.slice(0, 300));
  })
  .catch(error => {
    console.error("Erro ao carregar contatos:", error);
    document.getElementById("corpoTabela").innerHTML =
      `<tr><td colspan="36" class="no-results">Erro ao carregar os contatos.</td></tr>`;
  });

document.getElementById("pesquisa").addEventListener("input", filtrarTabela);
</script>

</body>
</html>
